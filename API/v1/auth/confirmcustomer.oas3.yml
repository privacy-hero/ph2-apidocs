openapi: 3.0.1
info:
  title: "Privacy Hero 2 - Mothership API - /auth/confirmcustomer"
  version: "1.0"
  description: |-
    Privacy Hero 2 API.

    `/auth/confirmcustomer`
  license:
    name: Copyright Â© 2020 HelpOn Inc. All Rights Reserved
  contact:
    name: API Support
    url: http://www.example.com/support
    email: support@example.com

###### THE SERVERS WHERE THIS API CAN BE USED ############
servers:
  - url: https://{awsid}.execute-api.us-east-1.amazonaws.com/dev
    description: Development URL
    variables:
      awsid:
        default: "999999"
        description: The ID for your dev AWS deployment

components:
  securitySchemes:
    $ref: "../../PH2-API.oas3.yml#/components/securitySchemes"

tags:
  - name: Account Management
    description: Operations related to Account Creation and Management

paths:
  "/auth/confirmcustomer":
    post:
      operationId: confirmCustomer
      tags:
        - Account Management
      summary: Confirm the New Customer Request
      description: |-
        Confirms creation of the new account for a Customer, via the back link
        provided by the email to the customer.

        ## Security Requirements
          - **appKey** must be valid and present in the call.
          - **clientToken** may be present, but is ignored.

        Must have a valid appKey for the request to be processed.

        ## Parameters
          - **verify**: The token passed to the callback which invoked this API
          call.
          - **pwd**: The clients chosen password.  This should only be provided
          if the callback specified that a password was required.
      requestBody:
        required: true
        content:
          "application/json":
            schema:
              type: object
              required:
                - verify
              additionalProperties: false
              properties:
                verify:
                  $ref: "../../inc/simpletypes.oas3.yml#/components/schemas/ph2-bearer-token"
                pwd:
                  $ref: "../../inc/simpletypes.oas3.yml#/components/schemas/password"

      security:
        - appKey: []

      responses:
        "200":
          description: |-
            The message was accepted, and the account has been created.
          content:
            application/json:
              schema:
                $ref: "../../inc/auth.oas3.yml#/components/schemas/Authorized"
        "400":
          description: |-
            General Request processing error.  Possible errors are:
            * `"Internal Server Error."` - Fatal uncategorized error in server.
            * `"Required Parameters missing or malformed."` - JSON Message Body Error.
          content:
            application/json:
              schema:
                $ref: "../../inc/response.oas3.yml#/components/schemas/Nack"
              example:
                error: "Internal Server Error."

        "401":
          $ref: "../../inc/response.oas3.yml#/components/responses/401-appKey"
        "403":
          $ref: "../../inc/response.oas3.yml#/components/responses/403-appKey"
        "415":
          $ref: "../../inc/response.oas3.yml#/components/responses/415"
        "429":
          $ref: "../../inc/response.oas3.yml#/components/responses/429"
        "500":
          $ref: "../../inc/response.oas3.yml#/components/responses/500"
        default:
          $ref: "../../inc/response.oas3.yml#/components/responses/default"
